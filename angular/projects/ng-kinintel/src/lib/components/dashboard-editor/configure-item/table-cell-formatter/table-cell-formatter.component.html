@if (type === 'number') {
  <label class="mb-2">
    Decimals
    <select matNativeControl [(ngModel)]="data.decimal"
      (ngModelChange)="setDecimalValue($event)">
      @for (decimal of [0,1,2,3,4,5,6,7,8,9]; track decimal) {
        <option
          [value]="decimal">
          {{decimal}}
        </option>
      }
    </select>
  </label>
}

@if (type === 'currency') {
  <label class="mb-2">
    Decimals
    <select matNativeControl [(ngModel)]="data.decimal"
      (ngModelChange)="setDecimalValue($event)">
      @for (decimal of [0,1,2,3,4,5,6,7,8,9]; track decimal) {
        <option
          [value]="decimal">
          {{decimal}}
        </option>
      }
    </select>
  </label>
  <div class="mb-4 flex items-center">
    <mat-checkbox class="mr-2" [(ngModel)]="data.thousandsSeparator"></mat-checkbox>
    <p class="mb-0 mt-1">Thousands Separator</p>
  </div>
  <label class="mb-4">
    Currency
    <select matNativeControl [compareWith]="selectOption" [(ngModel)]="data.currency">
      <option value="">-- Select Currency --</option>
      @for (currency of currencies; track currency) {
        <option [ngValue]="currency">
          {{currency.name}}
        </option>
      }
    </select>
  </label>
}

@if (type === 'percentage') {
  <label class="mb-2">
    Decimals
    <select matNativeControl [(ngModel)]="data.decimal"
      (ngModelChange)="setDecimalValue($event)">
      @for (decimal of [0,1,2,3,4,5,6,7,8,9]; track decimal) {
        <option
          [value]="decimal">
          {{decimal}}
        </option>
      }
    </select>
  </label>
  <div class="mb-4 flex items-center">
    <mat-checkbox class="mr-2" [(ngModel)]="data.thousandsSeparator"></mat-checkbox>
    <p class="mb-0 mt-1">Thousands Separator</p>
  </div>
}

@if (type === 'datetime') {
  <label class="mb-2">
    Date Format
    <select matNativeControl [(ngModel)]="data.dateFormat">
      @for (format of dateFormats; track format) {
        <option
          [value]="format.value">
          {{format.title}}
        </option>
      }
    </select>
  </label>
  <label class="mb-2">
    Time Format
    <select matNativeControl [(ngModel)]="data.timeFormat">
      @for (format of timeFormats; track format) {
        <option
          [value]="format.value">
          {{format.title}}
        </option>
      }
    </select>
  </label>
}

@if (type === 'comparison') {
  <label class="mb-2">
    Select Column to compare
    <select matNativeControl [(ngModel)]="data.comparisonColumn">
      <option [value]="undefined">-- Select Column --</option>
      @if (dataset) {
        @for (column of dataset.columns; track column) {
          <option
            [value]="column.name">
            {{column.title}}
          </option>
        }
      }
    </select>
  </label>
  <div class="mb-4 flex items-center">
    <mat-checkbox class="mr-2" [(ngModel)]="data.comparisonPercentage"></mat-checkbox>
    <p class="mb-0 mt-1">Display Change as Percentage</p>
  </div>
  <label class="mb-2">
    Decimals
    <select matNativeControl [(ngModel)]="data.comparisonDecimals"
      (ngModelChange)="setDecimalValue($event)">
      @for (decimal of [0,1,2,3,4,5,6,7,8,9]; track decimal) {
        <option
          [value]="decimal">
          {{decimal}}
        </option>
      }
    </select>
  </label>
}

@if (type === 'link') {
  <label class="mb-2">
    Link Settings
    <select matNativeControl [(ngModel)]="data.linkType">
      <option value="">External Link</option>
      <option value="custom">Custom Link</option>
      <option value="dashboard">Existing Dashboard</option>
    </select>
    <small class="font-normal">Select the destination for the action link</small>
  </label>
  @if (data.linkType === 'custom') {
    <p>Please enter the link for this call to action.</p>
    <label class="mb-2">
      Link
      <input type="text" [(ngModel)]="data.customLink">
    </label>
  }
  @if (data.linkType === 'dashboard') {
    <label class="mb-2">
      Select Dashboard
      <select matNativeControl [(ngModel)]="data.dashboardLink"
        [compareWith]="selectOption" (ngModelChange)="dashboardParamUpdate($event)">
        <optgroup label="Dashboards">
          @for (dashboard of dashboards; track dashboard) {
            <option
              [ngValue]="{value: dashboard.id, label: dashboard.title}">
              {{dashboard.title}}
            </option>
          }
        </optgroup>
        <optgroup label="Shared Dashboards">
          @for (dashboard of sharedDashboards; track dashboard) {
            <option
              [ngValue]="{value: dashboard.id, label: dashboard.title}">
              {{dashboard.title}}
            </option>
          }
        </optgroup>
        @if (privateDashboards.length) {
          <optgroup label="Private Dashboards">
            @for (dashboard of privateDashboards; track dashboard) {
              <option
                [ngValue]="{value: dashboard.id, label: dashboard.title}">
                {{dashboard.title}}
              </option>
            }
          </optgroup>
        }
      </select>
      <small class="font-normal">Select the destination for the action link</small>
    </label>
  }
  @if (data.dashboardLinkParams && dashboardParameters.length) {
    <p>Please enter the following parameters to use with this dashboard</p>
    @for (param of dashboardParameters; track param) {
      <label>{{param.title}}</label>
      @if (!data.dashboardLinkParams['custom-'+param.name]) {
        <label
          class="mb-2 dashboard-param-pick">
          <select matNativeControl [(ngModel)]="data.dashboardLinkParams[param.name]"
            [compareWith]="ctaSelectOption">
            <option>-- Select Value --</option>
            @if (dataset) {
              @for (column of dataset.columns; track column) {
                <option
                  [value]="'[['+column.name+']]'">
                  {{column.title}}
                </option>
              }
            }
          </select>
        </label>
      }
      <div class="mb-2 flex items-center">
        <mat-checkbox class="mr-2"
        [(ngModel)]="data.dashboardLinkParams['custom-'+param.name]"></mat-checkbox>
        <p class="mb-0 mt-1">Use custom value</p>
      </div>
      <label class="mb-2 dashboard-param-pick">
        @if (data.dashboardLinkParams['custom-'+param.name]) {
          <input type="text"
            placeholder="Enter custom parameter value"
            [(ngModel)]="data.dashboardLinkParams[param.name]">
        }
      </label>
    }
  }
}

@if (type === 'custom') {
  <div class="flex items-center mb-2 justify-between">
    <div class="font-semibold">Enter the HTML/Text for this item</div>
    <a (click)="openSide.next(true)"
      class="text-xs ml-2 hover:underline flex items-center primary">
      view help docs&nbsp;
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20"
        fill="currentColor">
        <path
          d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"/>
        <path
          d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"/>
      </svg>
    </a>
  </div>
  <textarea class="font-mono w-full"
  cols="30" rows="10" [(ngModel)]="data.customText"></textarea>
}

@if (type === 'action') {
  <label class="mb-2">
    Action Event
    <select matNativeControl [(ngModel)]="data.actionEvent">
      @for (actionEvent of actionEvents; track actionEvent) {
        <option [value]="actionEvent.name">
          {{actionEvent.title}}
        </option>
      }
    </select>
    <small class="font-normal">Select the action event to be triggered when this item is clicked.</small>
  </label>
}
