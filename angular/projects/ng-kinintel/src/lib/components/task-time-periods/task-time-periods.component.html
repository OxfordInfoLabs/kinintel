@if (showTitle) {
  <p><b>Time Periods</b></p>
}

@for (time of taskTimePeriods; track time; let i = $index) {
  <div class="time-period">
    <div class="align-center justify-between">
      <div>
        @for (key of Object.keys(time); track key) {
          @if (key !== 'id' && time[key]) {
            <span class="mr-2"><span class="capitalize"><b>{{_.startCase(key)}}:</b></span>&nbsp;<span>{{time[key]}}</span></span>
          }
        }
      </div>
      <button mat-icon-button color="warn" (click)="removeTime(i)">
        <mat-icon>clear</mat-icon>
      </button>
    </div>
  </div>
}

<button mat-button color="primary" (click)="addScheduleTime()">
  <mat-icon>more_time</mat-icon>&nbsp;Add scheduled time
</button>

@if (showNewTaskTimePeriod) {
  <div class="w-full bg-gray-50 p-4 mt-4">
    <div class="mb-2 text-xs ">Enter the frequency for the desired time period then click
      <span class="font-medium">Save time period</span></div>
      <form #timeForm="ngForm" class="w-1/2">
        <label class="mb-4">
          Frequency
          <mat-select #frequency="ngModel" [class]="{'border-red-600': frequency.invalid}"
            [(ngModel)]="newTaskTimePeriod.frequency" name="frequency" required>
            <mat-option value="Monthly">Monthly</mat-option>
            <mat-option value="Weekly">Weekly</mat-option>
            <mat-option value="Daily">Daily</mat-option>
            <mat-option value="Hourly">Hourly</mat-option>
          </mat-select>
        </label>
        @if (['Monthly'].indexOf(newTaskTimePeriod.frequency) > -1) {
          <label class="mb-4">
            Day of month
            <mat-select #month="ngModel" [class]="{'border-red-600': month.invalid}"
              [(ngModel)]="newTaskTimePeriod.dayInMonth" name="month" required>
              @for (day of _.range(1, 29); track day) {
                <mat-option [value]="day">
                  {{day}}
                </mat-option>
              }
            </mat-select>
          </label>
        }
        @if (['Weekly'].indexOf(newTaskTimePeriod.frequency) > -1) {
          <label class="mb-4">
            Day of week
            <mat-select #week="ngModel" [class]="{'border-red-600': week.invalid}"
              [(ngModel)]="newTaskTimePeriod.dayOfWeek" name="week" required>
              <mat-option [value]="1">Monday</mat-option>
              <mat-option [value]="2">Tuesday</mat-option>
              <mat-option [value]="3">Wednesday</mat-option>
              <mat-option [value]="4">Thursday</mat-option>
              <mat-option [value]="5">Friday</mat-option>
              <mat-option [value]="6">Saturday</mat-option>
              <mat-option [value]="7">Sunday</mat-option>
            </mat-select>
          </label>
        }
        @if (['Monthly', 'Weekly', 'Daily'].indexOf(newTaskTimePeriod.frequency) > -1) {
          <label class="mb-4"
            >
            Hour
            <mat-select #hour="ngModel" [class]="{'border-red-600': hour.invalid}"
              [(ngModel)]="newTaskTimePeriod.hour" name="hour" required>
              @for (hour of _.range(0, 24); track hour) {
                <mat-option [value]="hour < 10 ? '0' + hour : hour">
                  {{hour < 10 ? '0' + hour : hour}}
                </mat-option>
              }
            </mat-select>
          </label>
        }
        @if (['Monthly', 'Weekly', 'Daily', 'Hourly'].indexOf(newTaskTimePeriod.frequency) > -1) {
          <label class="mb-4"
            >
            Minute
            <mat-select #minute="ngModel" [class]="{'border-red-600': minute.invalid}"
              [(ngModel)]="newTaskTimePeriod.minute" name="minute" required>
              @for (minute of _.range(0, 60); track minute) {
                <mat-option [value]="minute < 10 ? '0' + minute : minute">
                  {{minute < 10 ? '0' + minute : minute}}
                </mat-option>
              }
            </mat-select>
          </label>
        }
        <div class="align-center justify-between">
          <div></div>
          <button mat-flat-button color="primary" (click)="addTimePeriod()"
            [disabled]="timeForm.invalid">Save time period
          </button>
        </div>
      </form>
    </div>
  }
