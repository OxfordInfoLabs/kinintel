<div class="dialog" cdkDrag cdkDragRootElement=".cdk-overlay-pane">

    <div class="dialog-title" cdkDragHandle>
        <h2 mat-dialog-title>Join Data</h2>

        <button mat-icon-button mat-dialog-close>
            <mat-icon>clear</mat-icon>
        </button>
    </div>

    <div class="dialog-content" id="formula-scroll">

        <p>Use expressions to create new derived columns from other columns. Use columns show below for calculations in
            your expressions.</p>

        <p><b>Available columns</b></p>

        <p [innerText]="_.map(allColumns, 'title').join(', ')"></p>

        <div class="formula-container" *ngFor="let formula of formulas; let i = index">
            <div class="formula-fields">
                <label>
                    Column label
                    <input type="text" [(ngModel)]="formula.fieldTitle">
                </label>

                <label>
                    Expression
                    <textarea name="" id="" cols="30" rows="2" [(ngModel)]="formula.expression"></textarea>
                </label>
            </div>

            <button mat-icon-button color="warn" (click)="removeFormula(i)">
                <mat-icon>remove_circle_outline</mat-icon>
            </button>
        </div>

        <button mat-button color="primary" (click)="addFormula()">
            <mat-icon>add_circle</mat-icon>
            Formula
        </button>

    </div>

    <div class="dialog-footer">
        <button mat-stroked-button color="primary" mat-dialog-close>Cancel</button>

        <button mat-flat-button color="primary" (click)="createFormula()"
                [disabled]="!_.every(this.formulas, 'fieldTitle') ||
                            !_.every(this.formulas, 'expression')">
            Create Formula
        </button>
    </div>

</div>


