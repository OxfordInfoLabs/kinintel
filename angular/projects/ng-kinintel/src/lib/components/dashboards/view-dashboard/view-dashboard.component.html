<ng-template [ngIf]="!gridOnly">

    <div class="dashboard-header align-center justify-between flex-wrap bg-white p-2 border-b border-gray-200">

        <h2 class="dashboard-title ml-2">{{dashboard.title}}</h2>

        <div class="flex items-center">
            <ng-template [ngIf]="fullOnly">
                <div *ngIf="refreshInterval" class="text-gray-400 text-xs">every {{refreshInterval / 60}} Minutes</div>
                <button mat-icon-button class="align-center" [matMenuTriggerFor]="menu"
                        matTooltip="Set refresh interval">
                    <mat-icon>autorenew</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item (click)="setRefreshInterval(0)">Off</button>
                    <button mat-menu-item (click)="setRefreshInterval(60)">Every 1 Minute</button>
                    <button mat-menu-item (click)="setRefreshInterval(300)">Every 5 Minutes</button>
                    <button mat-menu-item (click)="setRefreshInterval(600)">Every 10 Minutes</button>
                    <button mat-menu-item (click)="setRefreshInterval(1800)">Every 30 Minutes</button>
                    <button mat-menu-item (click)="setRefreshInterval(3600)">Every 60 Minutes</button>
                </mat-menu>
                <button mat-icon-button class="align-center" (click)="toggleParameters()"
                        matTooltip="Hide parameter bar">
                    <mat-icon>keyboard_hide</mat-icon>
                </button>
                <button mat-icon-button class="align-center" matTooltip="Toggle between light/dark mode"
                        (click)="toggleDarkMode()">
                    <mat-icon *ngIf="darkMode">light_mode</mat-icon>
                    <mat-icon *ngIf="!darkMode">dark_mode</mat-icon>
                </button>
            </ng-template>
            <ng-template [ngIf]="!fullOnly">
                <button mat-button class="align-center" matTooltip="View full screen"
                        (click)="viewFullscreen()">
                    <mat-icon>fullscreen</mat-icon>
                </button>
            </ng-template>
            <button mat-button class="align-center" matTooltip="Enable editing of Alerts"
                    (click)="editNotifications()">
                <mat-icon>edit_notifications</mat-icon>
            </button>
        </div>

    </div>

    <ng-template [ngIf]="!hideParameters">
        <div class="dashboard-parameters bg-gray-50 px-4 py-0.5 border-b border-gray-200"
             *ngIf="dashboard.layoutSettings && _.values(dashboard.layoutSettings.parameters).length">
            <div class="list-title">
                Parameters
            </div>
            <ng-template ngFor let-parameter [ngForOf]="_.values(dashboard.layoutSettings.parameters)">
                <label>
                    {{parameter.title}}
                    <div class="parameter-input">
                        <ng-template [ngIf]="parameter.type === 'text'">
                            <input class="pr-8" type="text" placeholder="Enter {{parameter.title}}" [(ngModel)]="parameter.value"
                                   (change)="setParameterValue(parameter, $event.target.value)" required autofocus
                                   [disabled]="parameter.locked">
                        </ng-template>
                        <ng-template [ngIf]="parameter.type === 'numeric'">
                            <input class="pr-8" type="number" placeholder="Enter {{parameter.title}}" [(ngModel)]="parameter.value"
                                   (change)="setParameterValue(parameter, $event.target.value)" required autofocus
                                   [disabled]="parameter.locked">
                        </ng-template>
                        <ng-template [ngIf]="parameter.type === 'date' || parameter.type === 'datetime'">
                            <ng-template [ngIf]="!parameter._dateType">
                                <div class="flex items-center mr-8">
                                    <button (click)="changeDateType($event, parameter, 'picker')"
                                            class="hover:bg-gray-50 text-gray-800 border border-gray-300 py-0.5 pr-2 rounded mr-2 bg-white flex items-center">
                                        <mat-icon class="text-base">calendar_month</mat-icon>
                                        Date Picker
                                    </button>
                                    <button (click)="changeDateType($event, parameter, 'period')"
                                            class="hover:bg-gray-50 text-gray-800 border border-gray-300 py-0.5 pr-2 rounded mr-2 bg-white flex items-center">
                                        <mat-icon class="text-base">restore</mat-icon>
                                        Time Period
                                    </button>
                                </div>
                            </ng-template>
                            <ng-template [ngIf]="parameter._dateType === 'picker'">
                                <input [type]="parameter.type === 'date' ? 'date' : 'datetime-local'" placeholder="Enter {{parameter.title}}" [(ngModel)]="parameter.value"
                                       (change)="setParameterValue(parameter, $event.target.value)" required autofocus
                                       [disabled]="parameter.locked">

                                <a (click)="changeDateType($event, parameter, 'period')"
                                   matTooltip="Time Period"
                                   class="text-center ml-2 hover:bg-gray-50 text-gray-800 border border-gray-300 py-0.5 pr-0.5 rounded mr-2 bg-white flex items-center">
                                    <mat-icon class="text-base">restore</mat-icon>
                                </a>
                            </ng-template>
                            <ng-template [ngIf]="parameter._dateType === 'period'">
                                <div class="flex items-center">
                                    <input #periodValue type="number" placeholder="No." required autofocus
                                           class="w-16 mr-2" min="0" [value]="parameter._periodValue || 1"
                                           (change)="updatePeriodValue(periodValue.value, period.value, parameter)"
                                           [disabled]="parameter.locked">

                                    <select class="param-period-picker mr-2" [value]="parameter._period || 'DAYS'"
                                            [disabled]="parameter.locked"
                                            #period (change)="updatePeriodValue(periodValue.value, period.value, parameter)">
                                        <option value="DAYS">Days</option>
                                        <option value="HOURS">Hours</option>
                                    </select>

                                    <div>Ago</div>
                                </div>

                                <a (click)="changeDateType($event, parameter, 'picker')"
                                   matTooltip="Date Picker"
                                   class="text-center ml-2 hover:bg-gray-50 text-gray-800 border border-gray-300 py-0.5 pr-0.5 rounded mr-2 bg-white flex items-center">
                                    <mat-icon class="text-base">calendar_month</mat-icon>
                                </a>
                            </ng-template>

                        </ng-template>
                        <ng-template [ngIf]="parameter.type === 'boolean'">
                            <mat-slide-toggle class="pr-8" color="primary" [disabled]="parameter.locked"
                                              [checked]="parameter.value" (change)="booleanUpdate($event, parameter)"
                                              required></mat-slide-toggle>
                        </ng-template>
                    </div>
                </label>

                <div class="divider" *ngIf="_.values(dashboard.layoutSettings.parameters).length > 1"></div>
            </ng-template>
            <button mat-stroked-button class="mr-2 bg-white" *ngIf="_.values(dashboard.layoutSettings.parameters).length">
                Apply
            </button>
        </div>
    </ng-template>

</ng-template>
<div class="grid-stack"></div>
